<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>ü¶ê Happy Birthday David Buivid! üéâ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        @media (prefers-reduced-motion: reduce) {
            @keyframes gradientShift {
                0%, 100% { background-position: 0% 50%; }
            function animate() {
        }
        
        body {
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        #gate {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
        
        #gate h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-align: center;
            padding: 0 1rem;
        }
        
        #startBtn {
            font-size: 1.5rem;
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            background: linear-gradient(45deg, #f093fb, #f5576c);
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s;
        }
        
        #startBtn:active {
            transform: scale(0.95);
        }
        
        #birthday-message {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            pointer-events: none;
            z-index: 10;
        }
        
        #birthday-message h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .shrimp {
            position: absolute;
            width: 80px;
            height: 40px;
            transform-origin: center;
            will-change: transform;
            cursor: grab;
        }
        
        #shake-message {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            font-weight: bold;
            color: white;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
            animation: shake-text 0.5s ease-in-out infinite alternate;
            pointer-events: none;
            z-index: 10;
            display: none;
        }
        
        @keyframes shake-text {
            0% { transform: translateX(-50%) rotate(-5deg) scale(1); }
            100% { transform: translateX(-50%) rotate(5deg) scale(1.1); }
        }
    </style>
</head>
<body>
    <div id="gate">
        <h1>ü¶ê Happy Birthday David Buivid! ü¶ê</h1>
        <button id="startBtn">Tap to start the shrimp party ü¶êüéâ</button>
    </div>
    
    <div id="birthday-message" style="display: none;">
        <h1>üéâ Happy Birthday David! üéâ</h1>
        <p>Shake to spawn more shrimp!</p>
    </div>
    
    <div id="shake-message" style="display: none;">
        ü¶ê SHAKE IT UP! ü¶ê
    </div>
    
    <script>
        console.log('Script starting...');
        
        // Shrimp sprites
        const shrimpSprites = [
            'data:image/svg+xml;base64,' + btoa('<svg width="80" height="40" xmlns="http://www.w3.org/2000/svg"><g transform="rotate(-10 40 20)"><ellipse cx="20" cy="20" rx="18" ry="12" fill="#ff6b35" stroke="#d64545" stroke-width="1"/><ellipse cx="35" cy="20" rx="15" ry="10" fill="#ff7745" stroke="#d64545" stroke-width="1"/><ellipse cx="48" cy="20" rx="12" ry="8" fill="#ff8855" stroke="#d64545" stroke-width="1"/><ellipse cx="58" cy="20" rx="8" ry="6" fill="#ff9965" stroke="#d64545" stroke-width="1"/><path d="M63 20 L70 15 L72 20 L70 25 Z" fill="#ff6b35" stroke="#d64545" stroke-width="1"/><circle cx="15" cy="17" r="3" fill="#000"/><circle cx="16" cy="16" r="1" fill="#fff"/><path d="M10 15 Q5 10 3 8 M10 17 Q5 15 2 15" stroke="#d64545" stroke-width="1.5" fill="none"/><path d="M20 25 L18 30 M25 26 L23 31 M30 26 L28 31 M35 25 L33 30" stroke="#d64545" stroke-width="1" fill="none"/></g></svg>'),
            'data:image/svg+xml;base64,' + btoa('<svg width="80" height="40" xmlns="http://www.w3.org/2000/svg"><g transform="rotate(-10 40 20)"><ellipse cx="20" cy="20" rx="18" ry="12" fill="#ff1493" stroke="#c71585" stroke-width="1"/><ellipse cx="35" cy="20" rx="15" ry="10" fill="#ff69b4" stroke="#c71585" stroke-width="1"/><ellipse cx="48" cy="20" rx="12" ry="8" fill="#ffb6c1" stroke="#c71585" stroke-width="1"/><ellipse cx="58" cy="20" rx="8" ry="6" fill="#ffc0cb" stroke="#c71585" stroke-width="1"/><path d="M63 20 L70 15 L72 20 L70 25 Z" fill="#ff1493" stroke="#c71585" stroke-width="1"/><circle cx="15" cy="17" r="3" fill="#000"/><circle cx="16" cy="16" r="1" fill="#fff"/><path d="M10 15 Q5 10 3 8 M10 17 Q5 15 2 15" stroke="#c71585" stroke-width="1.5" fill="none"/><path d="M20 25 L18 30 M25 26 L23 31 M30 26 L28 31 M35 25 L33 30" stroke="#c71585" stroke-width="1" fill="none"/></g></svg>'),
            'data:image/svg+xml;base64,' + btoa('<svg width="80" height="40" xmlns="http://www.w3.org/2000/svg"><g transform="rotate(-10 40 20)"><ellipse cx="20" cy="20" rx="18" ry="12" fill="#9370db" stroke="#7b68ee" stroke-width="1"/><ellipse cx="35" cy="20" rx="15" ry="10" fill="#a58fe9" stroke="#7b68ee" stroke-width="1"/><ellipse cx="48" cy="20" rx="12" ry="8" fill="#b19cd9" stroke="#7b68ee" stroke-width="1"/><ellipse cx="58" cy="20" rx="8" ry="6" fill="#dda0dd" stroke="#7b68ee" stroke-width="1"/><path d="M63 20 L70 15 L72 20 L70 25 Z" fill="#9370db" stroke="#7b68ee" stroke-width="1"/><circle cx="15" cy="17" r="3" fill="#000"/><circle cx="16" cy="16" r="1" fill="#fff"/><path d="M10 15 Q5 10 3 8 M10 17 Q5 15 2 15" stroke="#7b68ee" stroke-width="1.5" fill="none"/><path d="M20 25 L18 30 M25 26 L23 31 M30 26 L28 31 M35 25 L33 30" stroke="#7b68ee" stroke-width="1" fill="none"/></g></svg>'),
            'data:image/svg+xml;base64,' + btoa('<svg width="80" height="40" xmlns="http://www.w3.org/2000/svg"><g transform="rotate(-10 40 20)"><ellipse cx="20" cy="20" rx="18" ry="12" fill="#00ced1" stroke="#008b8b" stroke-width="1"/><ellipse cx="35" cy="20" rx="15" ry="10" fill="#40e0d0" stroke="#008b8b" stroke-width="1"/><ellipse cx="48" cy="20" rx="12" ry="8" fill="#48d1cc" stroke="#008b8b" stroke-width="1"/><ellipse cx="58" cy="20" rx="8" ry="6" fill="#afeeee" stroke="#008b8b" stroke-width="1"/><path d="M63 20 L70 15 L72 20 L70 25 Z" fill="#00ced1" stroke="#008b8b" stroke-width="1"/><circle cx="15" cy="17" r="3" fill="#000"/><circle cx="16" cy="16" r="1" fill="#fff"/><path d="M10 15 Q5 10 3 8 M10 17 Q5 15 2 15" stroke="#008b8b" stroke-width="1.5" fill="none"/><path d="M20 25 L18 30 M25 26 L23 31 M30 26 L28 31 M35 25 L33 30" stroke="#008b8b" stroke-width="1" fill="none"/></g></svg>'),
            'data:image/svg+xml;base64,' + btoa('<svg width="80" height="40" xmlns="http://www.w3.org/2000/svg"><g transform="rotate(-10 40 20)"><ellipse cx="20" cy="20" rx="18" ry="12" fill="#ffd700" stroke="#daa520" stroke-width="1"/><ellipse cx="35" cy="20" rx="15" ry="10" fill="#ffed4e" stroke="#daa520" stroke-width="1"/><ellipse cx="48" cy="20" rx="12" ry="8" fill="#fff68f" stroke="#daa520" stroke-width="1"/><ellipse cx="58" cy="20" rx="8" ry="6" fill="#fffacd" stroke="#daa520" stroke-width="1"/><path d="M63 20 L70 15 L72 20 L70 25 Z" fill="#ffd700" stroke="#daa520" stroke-width="1"/><circle cx="15" cy="17" r="3" fill="#000"/><circle cx="16" cy="16" r="1" fill="#fff"/><path d="M10 15 Q5 10 3 8 M10 17 Q5 15 2 15" stroke="#daa520" stroke-width="1.5" fill="none"/><path d="M20 25 L18 30 M25 26 L23 31 M30 26 L28 31 M35 25 L33 30" stroke="#daa520" stroke-width="1" fill="none"/></g></svg>')
        ];
        
        console.log('Sprites loaded:', shrimpSprites.length);
        
        // Shrimp class
        class Shrimp {
            constructor(x, y, spriteIndex) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 200;
                this.vy = (Math.random() - 0.5) * 200;
                this.angle = Math.random() * Math.PI * 2;
                this.angularVelocity = (Math.random() - 0.5) * 5;
                this.spriteIndex = spriteIndex;
                this.width = 80;
                this.height = 40;
                this.bounciness = 0.85 + Math.random() * 0.1;
                this.mass = 0.8 + Math.random() * 0.4;
                this.swimTimer = Math.random() * Math.PI * 2;
                this.isDragging = false;
                this.touchId = null;
                
                this.element = document.createElement('img');
                this.element.className = 'shrimp';
                this.element.src = shrimpSprites[spriteIndex % shrimpSprites.length];
                this.element.style.filter = `hue-rotate(${Math.random() * 30 - 15}deg) brightness(${0.9 + Math.random() * 0.2})`;
                document.body.appendChild(this.element);
                
                this.element.addEventListener('touchstart', this.handleTouchStart.bind(this), { passive: false });
                this.element.addEventListener('mousedown', this.handleMouseDown.bind(this));
            }
            
            handleTouchStart(e) {
                e.preventDefault();
                const touch = e.touches[0];
                this.startDrag(touch.identifier, touch.clientX, touch.clientY);
            }
            
            handleMouseDown(e) {
                e.preventDefault();
                this.startDrag('mouse', e.clientX, e.clientY);
            }
            
            startDrag(id, x, y) {
                this.isDragging = true;
                this.touchId = id;
                this.dragStartX = x;
                this.dragStartY = y;
                this.dragStartTime = Date.now();
                this.lastDragX = x;
                this.lastDragY = y;
                this.element.style.cursor = 'grabbing';
                this.element.style.zIndex = '100';
            }
            
            handleDrag(x, y) {
                if (!this.isDragging) return;
                
                const dx = x - this.lastDragX;
                const dy = y - this.lastDragY;
                
                this.x = x;
                this.y = y;
                this.vx = dx * 10;
                this.vy = dy * 10;
                
                this.lastDragX = x;
                this.lastDragY = y;
            }
            
            endDrag() {
                if (!this.isDragging) return;
                
                const dragTime = Date.now() - this.dragStartTime;
                const dragDistance = Math.sqrt(
                    Math.pow(this.lastDragX - this.dragStartX, 2) + 
                    Math.pow(this.lastDragY - this.dragStartY, 2)
                );
                
                if (dragTime < 200 && dragDistance > 30) {
                    const flickMultiplier = Math.min(dragDistance / 50, 3);
                    this.vx *= flickMultiplier;
                    this.vy *= flickMultiplier;
                    this.angularVelocity = (Math.random() - 0.5) * 20;
                }
                
                this.isDragging = false;
                this.touchId = null;
                this.element.style.cursor = 'grab';
                this.element.style.zIndex = '';
            }
            
            update(dt, gravity, damping) {
                if (this.isDragging) return;
                
                this.swimTimer += dt * 3;
                const swimForce = Math.sin(this.swimTimer) * 20;
                
                this.vx += (gravity.x * 2.5 * dt + Math.cos(this.angle) * swimForce * dt) / this.mass;
                this.vy += (gravity.y * 2.5 * dt + Math.sin(this.angle) * swimForce * dt) / this.mass;
                
                this.vx += (Math.random() - 0.5) * 50 * dt;
                this.vy += (Math.random() - 0.5) * 50 * dt;
                
                this.vx *= damping;
                this.vy *= damping;
                this.angularVelocity *= damping;
                
                this.x += this.vx * dt;
                this.y += this.vy * dt;
                this.angle += this.angularVelocity * dt;
                
                if (this.x < this.width/2) {
                    this.x = this.width/2;
                    this.vx = Math.abs(this.vx) * this.bounciness;
                    this.angularVelocity = this.vx * 0.05;
                }
                if (this.x > window.innerWidth - this.width/2) {
                    this.x = window.innerWidth - this.width/2;
                    this.vx = -Math.abs(this.vx) * this.bounciness;
                    this.angularVelocity = -this.vx * 0.05;
                }
                if (this.y < this.height/2) {
                    this.y = this.height/2;
                    this.vy = Math.abs(this.vy) * this.bounciness;
                    this.angularVelocity += (Math.random() - 0.5) * 3;
                }
                if (this.y > window.innerHeight - this.height/2) {
                    this.y = window.innerHeight - this.height/2;
                    this.vy = -Math.abs(this.vy) * this.bounciness;
                    this.angularVelocity += (Math.random() - 0.5) * 3;
                }
                
                const speed = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                const scale = 1 + Math.min(speed / 500, 0.3);
                this.element.style.transform = `translate(${this.x - this.width/2}px, ${this.y - this.height/2}px) rotate(${this.angle}rad) scale(${scale})`;
            }
            
            applyForce(fx, fy) {
                this.vx += fx / this.mass;
                this.vy += fy / this.mass;
                this.angularVelocity += (Math.random() - 0.5) * 10;
            }
            
            checkCollision(other) {
                const dx = this.x - other.x;
                const dy = this.y - other.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const minDistance = (this.width + other.width) * 0.7;
                
                if (distance < minDistance && distance > 0) {
                    const angle = Math.atan2(dy, dx);
                    const sin = Math.sin(angle);
                    const cos = Math.cos(angle);
                    
                    const vx1 = this.vx * cos + this.vy * sin;
                    const vy1 = this.vy * cos - this.vx * sin;
                    const vx2 = other.vx * cos + other.vy * sin;
                    const vy2 = other.vy * cos - other.vx * sin;
                    
                    const finalVx1 = ((this.mass - other.mass) * vx1 + 2 * other.mass * vx2) / (this.mass + other.mass);
                    const finalVx2 = ((other.mass - this.mass) * vx2 + 2 * this.mass * vx1) / (this.mass + other.mass);
                    
                    this.vx = finalVx1 * cos - vy1 * sin;
                    this.vy = vy1 * cos + finalVx1 * sin;
                    other.vx = finalVx2 * cos - vy2 * sin;
                    other.vy = vy2 * cos + finalVx2 * sin;
                    
                    const overlap = minDistance - distance;
                    const separateX = overlap * cos * 0.5;
                    const separateY = overlap * sin * 0.5;
                    this.x += separateX;
                    this.y += separateY;
                    other.x -= separateX;
                    other.y -= separateY;
                    
                    this.angularVelocity += (Math.random() - 0.5) * 8;
                    other.angularVelocity += (Math.random() - 0.5) * 8;
                }
            }
            
            destroy() {
                this.element.remove();
            }
        }
        
        let shrimps = [];
        let currentShrimpIndex = 0;
        let lastShakeTime = 0;
        let shakeCount = 0;
        let gravity = { x: 0, y: 100 };
        let lastTime = performance.now();
        let prefersReducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        
        function init() {
            console.log('Initializing...');
            document.getElementById('gate').remove();
            document.getElementById('birthday-message').style.display = 'block';
            
            for (let i = 0; i < 5; i++) {
                currentShrimpIndex = i;
                setTimeout(() => {
                    addShrimp(
                        Math.random() * window.innerWidth,
                        Math.random() * window.innerHeight
                    );
                }, i * 150);
            }
            
            if (!prefersReducedMotion) {
                window.addEventListener('devicemotion', handleMotion);
            }
            
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', handleTouchEnd);
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
            
            animate();
        }
        
        function addShrimp(x, y) {
            const shrimp = new Shrimp(x, y, currentShrimpIndex % shrimpSprites.length);
            shrimps.push(shrimp);
        }
        
        function addShrimpBurst() {
            currentShrimpIndex++;
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            // Create a burst of 3 shrimp
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const angle = (Math.PI * 2 * i) / 3;
                    const distance = 50;
                    const x = centerX + Math.cos(angle) * distance;
                    const y = centerY + Math.sin(angle) * distance;
                    
                    addShrimp(x, y);
                    
                    // Give them outward velocity
                    const newShrimp = shrimps[shrimps.length - 1];
                    newShrimp.vx = Math.cos(angle) * 150;
                    newShrimp.vy = Math.sin(angle) * 150;
                }, i * 50);
            }
        }
            const currentTime = performance.now();
            const dt = Math.min((currentTime - lastTime) / 1000, 0.1);
            lastTime = currentTime;
            
            const damping = prefersReducedMotion ? 0.95 : 0.985;
            
            for (let i = 0; i < shrimps.length; i++) {
                shrimps[i].update(dt, gravity, damping);
                
                for (let j = i + 1; j < shrimps.length; j++) {
                    shrimps[i].checkCollision(shrimps[j]);
                }
            }
            
            requestAnimationFrame(animate);
        }
        
        const SHAKE_THRESHOLD = 15;
        let shakeMessageTimeout;
        
        function handleMotion(event) {
            if (!event.accelerationIncludingGravity) return;
            const { x, y, z } = event.accelerationIncludingGravity;
            
            // Update gravity
            gravity.x = x * 30;
            gravity.y = -y * 30;
            
            // Calculate shake magnitude
            const magnitude = Math.sqrt(x * x + y * y + z * z);
            
            // Detect shake
            if (magnitude > SHAKE_THRESHOLD) {
                const now = Date.now();
                if (now - lastShakeTime > 300) {
                    lastShakeTime = now;
                    shakeCount++;
                    
                    console.log('Shake detected! Count:', shakeCount);
                    
                    // Show shake message
                    const shakeMsg = document.getElementById('shake-message');
                    shakeMsg.style.display = 'block';
                    clearTimeout(shakeMessageTimeout);
                    shakeMessageTimeout = setTimeout(() => {
                        shakeMsg.style.display = 'none';
                    }, 1500);
                    
                    // Apply force to all shrimp
                    shrimps.forEach(shrimp => {
                        shrimp.applyForce(
                            (Math.random() - 0.5) * 100,
                            (Math.random() - 0.5) * 100
                        );
                    });
                    
                    // Double shake spawns new shrimp
                    if (shakeCount % 2 === 0) {
                        addShrimpBurst();
                    }
                }
            }
        }
        
        function handleTouchMove(e) {
            e.preventDefault();
            for (let i = 0; i < e.touches.length; i++) {
                const touch = e.touches[i];
                shrimps.forEach(shrimp => {
                    if (shrimp.touchId === touch.identifier) {
                        shrimp.handleDrag(touch.clientX, touch.clientY);
                    }
                });
            }
        }
        
        function handleTouchEnd(e) {
            const remainingTouches = Array.from(e.touches).map(t => t.identifier);
            shrimps.forEach(shrimp => {
                if (shrimp.touchId && !remainingTouches.includes(shrimp.touchId)) {
                    shrimp.endDrag();
                }
            });
        }
        
        function handleMouseMove(e) {
            shrimps.forEach(shrimp => {
                if (shrimp.touchId === 'mouse') {
                    shrimp.handleDrag(e.clientX, e.clientY);
                }
            });
        }
        
        function handleMouseUp(e) {
            shrimps.forEach(shrimp => {
                if (shrimp.touchId === 'mouse') {
                    shrimp.endDrag();
                }
            });
        }
        
        async function requestMotion() {
            console.log('Requesting motion permission...');
            try {
                if (typeof DeviceMotionEvent?.requestPermission === 'function') {
                    const res = await DeviceMotionEvent.requestPermission();
                    console.log('Permission result:', res);
                }
            } catch (err) {
                console.log('Motion permission error:', err);
            }
            init();
        }
        
        document.getElementById('startBtn').addEventListener('click', requestMotion);
        console.log('Setup complete!');
    </script>
</body>
</html>
